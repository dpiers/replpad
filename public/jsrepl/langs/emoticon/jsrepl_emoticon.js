(function(){self.JSREPLEngine=function(){function c(a,b,d,e,g,h){this.input=a;this.output=b;this.error=e;this.sandbox=g;this.result_fn_factory=function(a){return function(b){var f,d,e,g;g="";for(d in b)f=b[d],e=f.toString(),f=e.length-74,f=f>0?f:0,e=e.slice(f),f>0&&(e="..."+e),g+="\n"+d+": "+e;return a(g)}};this.result_handler=this.result_fn_factory(d);this.interpreter=new this.sandbox.Emoticon.Interpreter({source:[],input:this.input,print:this.output,result:this.result_handler});h()}c.prototype.Eval=
function(a){var b;try{if(a.match(/^RESET\b/))this.interpreter=new this.sandbox.Emoticon.Interpreter({source:[],input:this.input,print:this.output,result:this.result_handler}),a=a.replace(/^RESET/,"");b=new this.sandbox.Emoticon.Parser(a);this.interpreter.lists.Z=this.interpreter.lists.Z.concat(b);return this.interpreter.run()}catch(d){return this.error(d)}};c.prototype.EvalSync=function(a){var b;this.interpreter.lists.Z=this.interpreter.lists.Z.concat(new this.sandbox.Emoticon.Parser(a));b=null;this.interpreter.result=
this.result_fn_factory(function(a){return b=a});this.interpreter.run();this.interpreter.result=this.result_handler;return b};c.prototype.GetNextLineIndent=function(a){var b,d=this;b=function(a){var b,h,c,i;h=new d.sandbox.Emoticon.Parser(a);a=0;for(c=0,i=h.length;c<i;c++)if(b=h[c],b.mouth)switch(b.mouth){case "(":++a;break;case ")":--a}return a};return b(a)<=0?false:(a=b(a.split("\n").slice(-1)[0]),a>0?1:a<0?a:0)};return c}()}).call(this);
